<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oz生日2025</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            background-image: url('img/background.jpg');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            justify-content: flex-end;
            align-items: center;
            flex-direction: column;
            min-height: 100vh;            
            font-family: Arial, sans-serif;
            overflow: hidden;
        }

        .image-container {
            position: relative;
            width: 800px;
            height: 800px;
            margin: 0px;
        }

        .foreground-img {
            position: absolute;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s, z-index 0.3s;
        }
                
        #cake {
            cursor: pointer;
            z-index: 2;
        }

        #oz {
            z-index: 1;
        }
                
        #cake:hover {
            transform: scale(1.05);
            z-index: 3;
        }

        #gift-boxes {
            display: none;
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: 4;
        }
        
        .gift-box {
            position: absolute;
            cursor: pointer;
            transition: transform 0.3s, z-index 0.3s;
            z-index: 1;
            /* 默认部分重叠 */
            margin-left: -20px;
        }
        
        .gift-box:hover {
            transform: scale(1.1);
            transform-origin: bottom;
            z-index: 10;
        }

        #table{
            position:absolute;
            bottom: 0;
            width: auto;
            height: auto;
            z-index: 6;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 100; /* 模态框在最上层 */
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            width: 80%;
            max-height: 80vh;
            overflow: hidden;
            position: relative;
        }
        
        .modal-body {
            max-height: calc(80vh - 100px);
            overflow-y: auto;
            padding: 10px;
            text-align: left;
        }
        
        .close-modal {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            z-index: 101;
        }

        /* 图片轮播样式 */
        .carousel {
            position: relative;
            width: 100%;
            height: 100%;
        }
        
        .carousel-images {
            display: flex;
            overflow: hidden;
            width: 100%;
            height: 300px;
        }
        
        .carousel-image {
            min-width: 100%;
            transition: transform 0.5s ease;
            object-fit: contain;
            max-height: 300px;
        }
        
        .carousel-btn {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(0,0,0,0.5);
            color: white;
            border: none;
            padding: 10px;
            cursor: pointer;
            z-index: 10;
        }
        
        .carousel-btn.prev {
            left: 10px;
        }
        
        .carousel-btn.next {
            right: 10px;
        }
        
        .carousel-indicators {
            display: flex;
            justify-content: center;
            margin-top: 10px;
        }
        
        .indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background-color: #ccc;
            margin: 0 5px;
            cursor: pointer;
        }
        
        .indicator.active {
            background-color: #333;
        }

        .title{
            font-weight: bold;
        }
        
        audio {
            display: none;
        }
        
    </style>
</head>
<body>
    <div class="image-container">
        <img id="oz" class="foreground-img">
        <img id="cake" class="foreground-img">

        <div id="gift-boxes">
            <img src="img/gift-e.png" class="gift-box" 
            style="bottom: 214px; left: 30%; z-index: 1;" 
            data-content="努图谷图展示<br>
               <div class='carousel'>
                    <div class='carousel-images'>
                        <img src='img/album/1.jpeg' class='carousel-image'>
                        <img src='img/album/2.jpg' class='carousel-image'>
                        <img src='img/album/3.jpeg' class='carousel-image'>
                        <img src='img/album/4.jpg' class='carousel-image'>
                        <img src='img/album/5.jpg' class='carousel-image'>
                    </div>
                    <button class='carousel-btn prev'>&lt;</button>
                    <button class='carousel-btn next'>&gt;</button>
                    <div class='carousel-indicators'></div>
                </div>"
            >
            
            <img src="img/gift-s.png" class="gift-box" 
            style="bottom: 214px; left: 50%; z-index: 2;" 
            data-content="<img src='img/pigeon.jpg' class='illustration'>">
            
            <img src="img/gift-w.png" class="gift-box" 
            style="bottom: 214px; left: 20%; z-index: 3;" 
            data-content="
                <span class='title'>同人文标题1</span>
                <br><br>
                <span class='text'>同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                </span>
            ">
            
           <img src="img/gift-c.png" class="gift-box" 
            style="bottom: 214px; left: 45%; z-index: 4;" 
            data-content="约稿展示<br>
                <img src='img/illustration.jpg' class='illustration'>
            ">

            <img src="img/gift-n.png" class="gift-box" 
            style="bottom: 214px; left: 65%; z-index: 5;" 
            data-content="
                <span class='title'>同人文标题2</span>
                <br><br>
                <span class='text'>同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                    同人文正文1<br>
                </span>
            ">

            <img src="img/table.png" id="table">

        </div>

    </div>

    <div class="modal" id="gift-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div class="modal-body" id="modal-body"></div>
        </div>
    </div>
     
    <audio id="music"></audio>
    
    <script>
    //定义各版本引用文件
    const versions = {
        version1: {
            cake: "img/cake1.png",
            oz: "img/oz1.png",
            cakeFire: "img/cake1-fire.png",

            audioSrc: "audio/BDaySong1.mp3",
            audioType: "audio/mpeg"
        },
        version2: {
            cake: "img/cake2.png",
            oz: "img/oz2.png",
            cakeFire: "img/cake2-fire.png",

            audioSrc: "audio/BDaySong2.mp3",
            audioType: "audio/mpeg"
        }
    };

    //随机选择版本
    const versionKeys = Object.keys(versions);
    const randomVersionKey = versionKeys[Math.floor(Math.random() * versionKeys.length)];
    const selectedVersion = versions[randomVersionKey];

    //获取DOM元素
    const cake = document.getElementById('cake');
    const oz = document.getElementById('oz');
    const musicPlayer = document.getElementById('music');
    
    const giftBoxes = document.getElementById('gift-boxes');
    const modal = document.getElementById('gift-modal');
    const modalBody = document.getElementById('modal-body');
    const closeModal = document.querySelector('.close-modal');

    //设置初始图片
    cake.src = selectedVersion.cake;
    oz.src = selectedVersion.oz;

    // 设置音频源
    const audioSource = document.createElement('source');
    audioSource.src = selectedVersion.audioSrc;
    audioSource.type = selectedVersion.audioType;
    musicPlayer.appendChild(audioSource);    

    let isOriginalImage = true;
        
    // 点击事件处理
    cake.addEventListener('click', function() {
        if (isOriginalImage) {
            this.src = selectedVersion.cakeFire;
            musicPlayer.currentTime = 0; // 从头开始播放
            musicPlayer.play();
            
            //5秒后显示礼物盒
            setTimeout(() => {
                this.style.display = 'none';
                giftBoxes.style.display = 'block';
            }, 5000);
        
        } 
            
        isOriginalImage = false;
    });
    
    // 礼物盒点击事件
    document.querySelectorAll('.gift-box').forEach(box => {
        box.addEventListener('click', function() {
            modalBody.innerHTML = this.getAttribute('data-content');
            modal.style.display = 'flex';
            
            // 初始化轮播（如果存在）
            initCarousel();
        });
    });
    
        
    // 关闭模态框
    closeModal.addEventListener('click', function() {
        modal.style.display = 'none';
    });
    
    // 点击模态框外部关闭
    window.addEventListener('click', function(event) {
        if (event.target === modal) {
            modal.style.display = 'none';
        }
    });
    

    // 轮播图功能
    function initCarousel() {
        const carousel = document.querySelector('.carousel');
        if (!carousel) return;
        
        const images = document.querySelectorAll('.carousel-image');
        const prevBtn = document.querySelector('.carousel-btn.prev');
        const nextBtn = document.querySelector('.carousel-btn.next');
        const indicatorsContainer = document.querySelector('.carousel-indicators');
        
        let currentIndex = 0;
        
        // 创建指示器
        images.forEach((_, index) => {
            const indicator = document.createElement('div');
            indicator.classList.add('indicator');
            if (index === 0) indicator.classList.add('active');
            indicator.addEventListener('click', () => goToSlide(index));
            indicatorsContainer.appendChild(indicator);
        });
        
        // 更新轮播状态
        function updateCarousel() {
            images.forEach((img, index) => {
                img.style.transform = `translateX(-${currentIndex * 100}%)`;
            });
            
            // 更新指示器
            document.querySelectorAll('.indicator').forEach((ind, index) => {
                ind.classList.toggle('active', index === currentIndex);
            });
        }
        
        // 前往指定幻灯片
        function goToSlide(index) {
            currentIndex = index;
            updateCarousel();
        }
        
        // 上一张
        prevBtn.addEventListener('click', () => {
            currentIndex = (currentIndex - 1 + images.length) % images.length;
            updateCarousel();
        });
        
        // 下一张
        nextBtn.addEventListener('click', () => {
            currentIndex = (currentIndex + 1) % images.length;
            updateCarousel();
        });
        
        // 初始化位置
        images.forEach((img, index) => {
            img.style.transform = `translateX(-${currentIndex * 100}%)`;
        });
        
        // 自动轮播
        let interval = setInterval(() => {
            currentIndex = (currentIndex + 1) % images.length;
            updateCarousel();
        }, 3000);
        
        // 鼠标悬停时暂停自动轮播
        carousel.addEventListener('mouseenter', () => {
            clearInterval(interval);
        });
        
        carousel.addEventListener('mouseleave', () => {
            interval = setInterval(() => {
                currentIndex = (currentIndex + 1) % images.length;
                updateCarousel();
            }, 3000);
        });
    }

    </script>


</body>
</html>